!function(){"use strict";function t(t){const{x:e,y:n}=t;return e*e+n*n}var e;!function(e){function n(t){return Math.hypot(t.x,t.y)}e.create=function(t=0,e=0){return{x:t,y:e}},e.vector=function(t,e){return{x:e.x-e.x,y:e.y-t.y}},e.distanceSquared=function(t,e){const n=t.x-e.x,o=t.y-e.y;return n*n+o*o},e.distance=function(t,e){return Math.hypot(t.x-e.x,t.y-e.y)},e.lengthSquared=t,e.length=n,e.normalize=function(t,e){let o=n(t);o>0&&(o=e/o,t.x*=o,t.y*=o)}}(e||(e={}));const n=Math.round,o=Math.random,i=Math.sin,a=Math.cos,r=Math.atan2,s=Math.abs,c=Math.max,h=Math.min,l=Math.sqrt,u=2*Math.PI;function d(t,e){return n(t+o()*(e-t))}function f(t,e){return t+o()*(e-t)}var p;!function(t){t.transformColor=function(t,e){let n=t>>24&255,o=t>>16&255,i=t>>8&255,a=255&t;return n=n*e.am+e.ao&255,o=o*e.rm+e.ro&255,i=i*e.gm+e.go&255,a=a*e.bm+e.bo&255,`rgba(${o}, ${i}, ${a}, ${n/255})`},t.formatColor=function(t){return`rgba(${t>>16&255}, ${t>>8&255}, ${255&t}, ${(t>>24&255)/255})`}}(p||(p={}));function y(t,e,n,r,s,c,h,l,u){let f=d(s,c);t.push(4,f);const p=2*Math.PI/f;for(void 0===u&&(u=Math.PI*o());f--;)t.push(n+i(u)*d(h,l),r+a(u)*d(h,l)),u+=p;t.push(0,e)}class m{constructor(t){this.actions=new Map,this.transitions=[],this._state=-1,this._reactionTime=0,this._time=0,this._reactionTime=t}setState(t,e){this._state=t;const n=this.getAction();n&&n.start(e)}getAction(){const t=this.actions.get(this._state);if(!t)throw"Action not found: "+this._state;return t}update(t){const e=this.getAction();if(e&&e.update(t),this._time-=t,this._time<=0){this._time=this._reactionTime+this._reactionTime*o();for(const t of this.transitions){const{from:e,to:n}=t;if(n!==this._state&&(0===e.length||e.includes(this._state))&&t.condition()){this.setState(n,t.data);break}}}}}var g;!function(t){t[t.PLAYER=0]="PLAYER",t[t.NPC=1]="NPC",t[t.ENEMY=2]="ENEMY",t[t.NEUTRAL=3]="NEUTRAL"}(g||(g={}));const x=new Map;function w(t,e){return t===e||x.get(t)===e}function b(t){const{radius:e,weight:n,color:o,type:i,health:a}=t,r=[o,4278190080],s=new m(t.reaction),c={radius:e,weight:n},h=[];return y(h,0,0,0,5,5,e,e,Math.PI/10),y(h,1,e/2,0,3,3,e/3,e/3,Math.PI/2),{type:i,shape:h,pallete:r,rotation:0,x:0,y:0,fsm:s,body:c,health:a,settings:t,weapon:0,onUpdate(t){this.fsm.update(t)}}}function v(t,n,o,r,s,c){const h={x:r.speed*a(o),y:r.speed*i(o)};let l=0;const u=e.length(h),{length:d,width:f,color:p}=r,y=f/2,m={x:t,y:n,rotation:o,body:{weight:0,radius:3,transparent:!0},shape:[4,3,-d,0,0,-y,0,y,0,0],pallete:[p],onUpdate(t){this.x+=h.x*t,this.y+=h.y*t,l+=u*t,l>r.distance&&c.removeBullet(m)},onCollision(t,n){if("health"in t){const n=t;if(!w(n.type,s)&&(n.health-=r.damage/r.points.length,c.removeBullet(m),r.impulse)){const t=e.create(h.x,h.y);e.normalize(t,r.impulse),c.addImpulse({target:n,value:t})}}}};return m}function E(t,e){let n=0,o=0;return(r,s)=>{if(s&&t.settings.weapons){const s=t.settings.weapons[t.weapon];if(n-=r,n<=0){n=1/s.frequency;const{rotation:r,type:c}=t;if(s.angle){let n=r-s.angle/2;const o=s.angle/s.points.length;for(const r of s.points){const h=a(n),l=i(n),{x:u,y:d}=r,f=v(t.x+u*h-d*l,t.y+u*l+d*h,n,s,c,e);e.addBullet(f),n+=o}}else{o++,o>=s.points.length&&(o=0);const n=a(r),h=i(r),{x:l,y:u}=s.points[o],d=v(t.x+l*n-u*h,t.y+l*h+u*n,r,s,c,e);e.addBullet(d)}}}else n=0}}var T,A,k,S,P;function M(t,e){const n=b(t),{walkSpeed:r}=t;n.rotation=u*o();const{fsm:s}=n,{actions:c,transitions:h}=s;return c.set(0,{update(t){n.rotation+=this.data.speed*t,this.data.time-=t},start(){this.data={speed:o()>.5?-1:1,time:f(.5,2)}}}),c.set(1,{update(t){n.x+=this.data.speedX*t,n.y+=this.data.speedY*t,this.data.time-=t},start(){this.data={speedX:a(n.rotation)*r,speedY:i(n.rotation)*r,time:f(1,3)}}}),c.set(3,{update(t){n.alpha-=t,n.alpha<0&&e.removeUnit(n)},start(){n.alpha=.9,n.body.enabled=!1}}),h.push({from:[1],to:0,condition:()=>n.x<-500?(n.x+=5,!0):n.x>500?(n.x-=5,!0):n.y<-500?(n.y+=5,!0):n.y>500?(n.y-=5,!0):s.getAction().data.time<0}),h.push({from:[0],to:1,condition:()=>s.getAction().data.time<0}),h.push({from:[],to:3,condition:()=>n.health<=0}),s.setState(0),n}function C(t,n){return{damage:n,speed:100,points:[e.create(t,0)],frequency:1,distance:20,color:4294901760,length:20,width:20,impulse:3}}function I(t){return{damage:20,points:[e.create(t,0)],frequency:3,speed:1e3,distance:1e3,color:4294967295,length:30,width:4,impulse:5}}function L(t){return{damage:40,points:[e.create(t,-5),e.create(t,5)],frequency:10,speed:1500,distance:1e3,color:4294967040,length:50,width:3,impulse:3}}function D(t){return{damage:150,points:new Array(10).fill(e.create(t,0)),frequency:1,speed:1e3,distance:300,color:4278255615,length:10,width:3,angle:.7,impulse:5}}function U(t){var e;return(0,(e=[I,L,D])[d(0,e.length-1)])(t)}function O(t,n){const o=e.distanceSquared(t,n),i=n.body.radius+t.body.radius;return o<1.1*(i*i)}function R(t){const n=f(25,45),s={type:2,radius:n,weight:3*n,health:4*n,color:4288217088,walkSpeed:f(80,150),reaction:.5,weapons:[C(n,n)]},c=M(s,t),{walkSpeed:h}=s,l=400;c.rotation=u*o();const{fsm:d}=c,{actions:p,transitions:y}=d,m=E(c,t);return p.set(10,{update(t){c.rotation=r(this.data.target.y-c.y,this.data.target.x-c.x);const e=a(c.rotation)*h,n=i(c.rotation)*h;c.x+=e*t,c.y+=n*t},start(t){this.data={target:t}}}),p.set(11,{update(t){m(t,!0)},start(t){this.data={target:t}}}),y.push({from:[0,1],to:10,condition(){const e=t.getNearOpponent(c,l);return!!e&&(this.data=e,!0)}}),y.push({from:[10,11],to:0,condition(){const n=d.getAction().data.target;if(n.health<=0)return!0;if(e.distanceSquared(n,c)>24e4)return!0;return t.getNearOpponent(c,l)!=n}}),y.push({from:[10],to:11,condition(){const t=d.getAction().data.target;return!!O(t,c)&&(this.data=t,!0)}}),y.push({from:[11],to:10,condition(){const t=d.getAction().data.target;return!O(t,c)&&(this.data=t,!0)}}),c}function q(t){const n={type:1,radius:30,weight:90,health:100,color:4288256256,walkSpeed:200,reaction:.2,weapons:[U(30)]},o=M(n,t),{fsm:i}=o,{actions:a,transitions:s}=i,{units:c}=t,{walkSpeed:h}=n,l=200,u=E(o,t);return a.set(10,{update(t){const n=this.data.target;o.rotation=r(n.y-o.y,n.x-o.x);const i=function(t,n,o,i){let{x:a,y:r}=t,s=1;for(const c of n)if(!w(c.type,t.type)){const n=e.vector(c,t);e.lengthSquared(n)<i&&(e.normalize(n,o),a+=n.x,r+=n.y,s++)}return s>1?(a/=s,r/=s,{x:a,y:r}):null}(o,c,l,4e4);if(i){const n=e.vector(o,i);e.lengthSquared(n)>h&&(e.normalize(n,h),o.x+=n.x*t,o.y+=n.y*t)}u(t,!0)},start(t){this.data={target:t}}}),s.push({from:[0,1],to:10,condition(){let e=t.getNearOpponent(o,l);return!!e&&(this.data=e,!0)}}),s.push({from:[10],to:0,condition(){const t=i.getAction().data.target;if(t.health<=0)return!0;return e.distanceSquared(t,o)>6e4}}),o}x.set(1,0),x.set(0,1),function(t){t[t.ROTATE=0]="ROTATE",t[t.WALK=1]="WALK",t[t.DEAD=3]="DEAD"}(T||(T={})),function(t){t[t.GOTO_TARGET=10]="GOTO_TARGET",t[t.ATTACK=11]="ATTACK"}(A||(A={})),function(t){t[t.ATTACK=10]="ATTACK"}(k||(k={}));class K{constructor(t,n){this.direction=e.create(),this.attack=!1,this.rotation=0,this.weapon=0,this.up=!1,this.down=!1,this.right=!1,this.left=!1,this.player=t,this.keyProcess=this.keyProcess.bind(this),n.onTouchMove=e=>{this.rotation=r(e.y-t.y,e.x-t.x)},n.onTouchDown=t=>{this.attack=!0},n.onTouchUp=t=>{this.attack=!1},n.onKeyDown=this.keyProcess,n.onKeyUp=this.keyProcess}keyProcess(t){const n="keydown"===t.type;switch(t.code){case"KeyW":case"ArrowUp":this.up=n;break;case"KeyS":case"ArrowDown":this.down=n;break;case"KeyA":case"ArrowLeft":this.left=n;break;case"KeyD":case"ArrowRight":this.right=n;break;case"Space":n&&this.player.settings.weapons&&(this.weapon++,this.weapon>=this.player.settings.weapons.length&&(this.weapon=0))}this.direction.x=0,this.direction.y=0,this.up&&(this.direction.y-=1),this.down&&(this.direction.y+=1),this.left&&(this.direction.x-=1),this.right&&(this.direction.x+=1),e.normalize(this.direction,1)}}class N{constructor(){this.direction=e.create(),this.attack=!1,this.rotation=0,this.weapon=0}}function _(t){const e={type:0,radius:30,weight:90,health:100,color:4278229401,walkSpeed:200,reaction:.2,weapons:[I(30),L(30),D(30)]},n=b(e),o=function(t,e){return"ontouchstart"in window?new N:new K(t,e)}(n,t),{fsm:i}=n,{actions:a,transitions:r}=i,{walkSpeed:s}=e,c=E(n,t);return a.set(0,{update(t){const e=s*t;n.x+=o.direction.x*e,n.y+=o.direction.y*e,n.rotation=o.rotation,n.weapon=o.weapon,c(t,o.attack)},start(){}}),a.set(1,{update(){},start(){n.alpha=.5,n.body.enabled=!1}}),r.push({from:[],to:1,condition:()=>n.health<=0}),i.setState(0),n}!function(t){t[t.ALIVE=0]="ALIVE",t[t.DEAD=1]="DEAD"}(S||(S={})),function(t){t[t.SIZE=0]="SIZE",t[t.FILL=1]="FILL",t[t.RECTANGLE=2]="RECTANGLE",t[t.ELLIPSE=3]="ELLIPSE",t[t.LINE=4]="LINE",t[t.REPEAT=5]="REPEAT",t[t.NOISE=6]="NOISE"}(P||(P={}));const Y=new Map;Y.set(0,((t,e,n)=>{const o=n.fillStyle;e.width=t.width,e.height=t.height,n.fillStyle=o,n.fillRect(0,0,e.width,e.height)})),Y.set(1,((t,e,n)=>{n.fillStyle=p.formatColor(t.color)})),Y.set(2,((t,e,n)=>{n.fillRect(t.x,t.y,t.width,t.height)})),Y.set(3,((t,e,n)=>{const o=t.width/2,i=t.height/2;n.beginPath(),n.ellipse(t.x+o,t.y+i,o,i,0,0,2*Math.PI),n.closePath(),n.fill()})),Y.set(5,((t,e,n,o)=>{const i=Y.get(o.type),a=o.x,r=t.stepX,s=t.stepY,c=t.cols;let h=t.count,l=1;for(o.x+=r;h--;)i(o,e,n,o),o.x+=r,l++,l===c&&(l=0,o.x=a,o.y+=s)})),Y.set(6,((t,e,n)=>{const i=t.colorOffset,a=i/2,r=n.getImageData(0,0,e.width,e.height),s=r.data;let c=0;for(;c<s.length;){const t=s[c],e=s[c+1],n=s[c+2];s[c]=t-a+i*o(),s[c+1]=e-a+i*o(),s[c+2]=n-a+i*o(),c+=4}n.putImageData(r,0,0)}));const $=[{type:1,color:4284900966},{type:0,width:512,height:512},{type:1,color:4286023799},{type:2,x:20,y:20,width:50,height:50},{type:5,stepX:70,stepY:70,count:48,cols:7},{type:1,color:4284900966},{type:2,x:140,y:140,width:220,height:220},{type:1,color:4286023799},{type:3,x:160,y:160,width:190,height:190}];function z(){const t=512,e={image:function(t){const e=document.createElement("canvas"),n=e.getContext("2d");let o;return t.forEach((t=>{Y.get(t.type)(t,e,n,o),o=t})),e}($),x:-256,y:-256},n=Math.hypot(t)/2,o=[];for(let t=0;t<10;t++)for(let i=0;i<10;i++)o.push({x:511*(t-5),y:511*(i-5),radius:n,children:[e]});return{children:o}}const B=e.create();function W(){const n=[],o=[],i=[],a=[];return{units:o,children:[z(),{children:o},{children:i}],onUpdate(o){!function(n,o){for(let o=0;o<n.length;o++){const i=n[o],a=i.body;if(!1!==a.enabled)for(let r=o+1;r<n.length;r++){const o=n[r],s=o.body;if(!1!==s.enabled){const n=a.radius+s.radius,r=n*n;B.x=i.x-o.x,B.y=i.y-o.y;const c=t(B);if(c<r){if(!a.transparent&&!s.transparent){const t=l(c),r=(n-t)/t,h=B.x*r,u=B.y*r,d=a.weight,f=s.weight,p=d+f,y=f/p,m=d/p;i.x+=h*y,i.y+=u*y,o.x-=h*m,o.y-=u*m,B.x=i.x-o.x,B.y=i.y-o.y,e.normalize(B,s.radius),B.x+=o.x,B.y+=o.y}i.onCollision&&i.onCollision(o,B),o.onCollision&&o.onCollision(i,B)}}}}}(n),function(t,n){for(const o of t){const{target:i,value:a}=o;i.x+=a.x,i.y+=a.y;const{weight:r}=i.body;let s=e.length(a);s-=s*r/4*n,s<.5?t.splice(t.indexOf(o)):e.normalize(a,s)}}(a,o)},addUnit(t){o.push(t),n.push(t)},removeUnit(t){o.splice(o.indexOf(t),1),n.splice(n.indexOf(t),1)},getUnitCount(t){let e=0;for(const n of this.units)n.type===t&&e++;return e},getNearOpponent(t,n){let i=null,a=n*n;for(const n of o)if(!w(n.type,t.type)&&n.health>0){const o=e.distanceSquared(n,t);o<a&&(a=o,i=n)}return i},addBullet(t){i.push(t),n.push(t)},removeBullet(t){i.splice(i.indexOf(t),1),n.splice(n.indexOf(t),1)},addImpulse(t){a.push(t)}}}function X(t,n,o,i){let a=100;for(;;){t.x=f(o,i),t.y=f(o,i);let r=!0;for(const o of n)if(!w(o.type,t.type)&&e.distanceSquared(t,o)<4e4){r=!1;break}if(r)break;if(a--<0)break}}function G(t){const n=function(){const t=e.create(),n=W(),o=_(n);n.addUnit(o);const i=600;for(let t=0;t<30;t++){const t=R(n);X(t,n.units,-600,i),n.addUnit(t)}const a=300;for(let t=0;t<10;t++){const t=q(n);t.x=f(-300,a),t.y=f(-300,a),n.addUnit(t)}return{camera:t,children:[n],size:2500,onUpdate(){if(n.getUnitCount(2)<30){const t=R(n);X(t,n.units,-600,i),n.addUnit(t)}},updateCamera(){var t;this.camera.x=o.x,this.camera.y=o.y,null===(t=this.children)||void 0===t||t.forEach((t=>{t.x=-this.camera.x,t.y=-this.camera.y}))},calculateVolume(n){const o=e.distance(t,n);return 1-h(1,c(0,o/1250))}}}();return{children:[n],updateView(e){const o=t.getWidth(),i=t.getHeight(),a=h(o/1024,i/1024);n.scale=a,n.x=o/2,n.y=i/2,n.updateCamera(e)}}}var V,H;!function(t){t.empty=function(){return{am:1,rm:1,gm:1,bm:1,ao:0,ro:0,go:0,bo:0}},t.concat=function(t,e,n){const o=t.am*e.am,i=t.rm*e.rm,a=t.gm*e.gm,r=t.bm*e.bm,s=t.am*e.ao+t.ao,c=t.rm*e.ro+t.ro,h=t.gm*e.go+t.go,l=t.bm*e.bo+t.bo;n.am=o,n.rm=i,n.gm=a,n.bm=r,n.ao=s,n.ro=c,n.go=h,n.bo=l}}(V||(V={})),function(t){function e(t){return t.a*t.d-t.b*t.c}t.empty=function(){return{a:1,b:0,c:0,d:1,x:0,y:0}},t.concat=function(t,e,n){const o=e.a*t.a+e.b*t.c,i=e.a*t.b+e.b*t.d,a=e.c*t.a+e.d*t.c,r=e.c*t.b+e.d*t.d,s=e.x*t.a+e.y*t.c+t.x,c=e.x*t.b+e.y*t.d+t.y;n.a=o,n.b=i,n.c=a,n.d=r,n.x=s,n.y=c},t.getScale=function(t){return c(s(t.a),s(t.b),s(t.c),s(t.d))},t.transformPoint=function(t,e,n){const{x:o,y:i}=e;n.x=o*t.a+i*t.c,n.y=o*t.b+i*t.d},t.getDeterminant=e,t.transformInversePoint=function(t,n,o){let i=e(t);if(0===i)o.x=-t.x,o.y=-t.y;else{i=1/i;const{x:e,y:a}=n;o.x=i*(t.c*(t.y-a)+t.d*(e-t.x)),o.y=i*(t.a*(a-t.y)+t.b*(t.x-e))}}}(H||(H={}));const F=H.empty();var Z;!function(t){function e(t,e){var n,o,i,a,r,s;const{rotation:c}=t,h=null!==(o=null!==(n=t.scaleX)&&void 0!==n?n:t.scale)&&void 0!==o?o:1,l=null!==(a=null!==(i=t.scaleY)&&void 0!==i?i:t.scale)&&void 0!==a?a:1;if(e.x=null!==(r=t.x)&&void 0!==r?r:0,e.y=null!==(s=t.y)&&void 0!==s?s:0,c){const t=Math.cos(c),n=Math.sin(c);return e.a=t*h,e.b=n*h,e.c=-n*l,void(e.d=t*l)}e.a=h,e.b=0,e.c=0,e.d=l}t.getMatrix=e,t.getColorTransform=function(t,e){var n;const o=null!==(n=t.alpha)&&void 0!==n?n:1,{tint:i}=t;if(i){const{color:t=0,value:n=1}=i,a=1-n,r=t>>16&255,s=t>>8&255,c=255&t;return e.am=o,e.rm=a,e.gm=a,e.bm=a,e.ao=0,e.ro=r*n,e.go=s*n,void(e.bo=c*n)}let{brightness:a}=t;if(void 0!==a){a>1?a=1:a<-1&&(a=-1);const t=1-Math.abs(a);let n=0;return a>0&&(n=255*a),e.am=o,e.rm=t,e.gm=t,e.bm=t,e.ao=0,e.ro=n,e.go=n,void(e.bo=n)}e.am=o,e.rm=1,e.gm=1,e.bm=1,e.ao=0,e.ro=0,e.go=0,e.bo=0},t.transformPoint=function(t,n,o){const{x:i,y:a}=n;e(t,F),o.x=i*F.a+a*F.c+F.x,o.y=i*F.b+a*F.d+F.y}}(Z||(Z={}));const j=e.create();var J;!function(t){t.render=function t(e,n,o,i){var a;if(e.onScreen=!1,!(null===(a=e.visible)||void 0===a||a))return;const r=H.empty();if(Z.getMatrix(e,r),H.concat(n,r,r),e.radius){const t=H.getScale(r)*e.radius;if(r.x+t<0||r.y+t<0||r.x-t>i.canvas.width-0||r.y-t>i.canvas.height-0)return}const s=V.empty();if(Z.getColorTransform(e,s),V.concat(o,s,s),s.am<=0)return;e.onScreen=!0,i.setTransform(r.a,r.b,r.c,r.d,r.x,r.y);const{shape:c,image:h,pallete:l,text:u,children:d}=e;c&&l&&function(t,e,n,o){for(let i=0;i<t.length;i++)switch(t[i]){case 0:o.fillStyle=p.transformColor(e[t[++i]],n),o.fill();break;case 1:o.strokeStyle=p.transformColor(e[t[++i]],n),o.lineWidth=t[++i],o.stroke();break;case 2:o.beginPath(),o.moveTo(t[++i],t[++i]);break;case 3:o.lineTo(t[++i],t[++i]);break;case 4:let a=t[++i];for(a--,o.beginPath(),o.moveTo(t[++i],t[++i]);a--;)o.lineTo(t[++i],t[++i]);break;default:throw`unknown command: ${t[i]}`}}(c,l,s,i),u&&function(t,e,n){var o,i,a;if(!t.value)return;n.fillStyle=p.transformColor(null!==(o=t.color)&&void 0!==o?o:4278190080,e),n.font=`${null!==(i=t.size)&&void 0!==i?i:10}px ${null!==(a=t.font)&&void 0!==a?a:"arial"}`,n.textBaseline="top";let r=0;t.align&&(r=-n.measureText(t.value).width*t.align),n.fillText(t.value,r,0)}(u,s,i),h&&function(t,e,n){n.fillStyle=n.createPattern(t,"no-repeat"),n.fillRect(0,0,t.width,t.height)}(h,0,i),d&&d.forEach((e=>t(e,r,s,i)))},t.update=function t(e,n){if(!1===e.enabled)return;e.onUpdate&&e.onUpdate(n);const{children:o}=e;o&&o.forEach((e=>t(e,n)))},t.keyProcess=function t(e,n,o){switch(o){case 1:e.onKeyDown&&e.onKeyDown(n);break;case 0:e.onKeyUp&&e.onKeyUp(n)}const{children:i}=e;i&&i.forEach((e=>t(e,n,o)))},t.touchProcess=function t(e,n,o,i){if(!1===e.touchable)return;const a=H.empty();switch(Z.getMatrix(e,a),H.concat(o,a,a),i){case 1:e.onTouchDown&&(H.transformInversePoint(a,n,j),e.onTouchDown(j,n));break;case 0:e.onTouchUp&&(H.transformInversePoint(a,n,j),e.onTouchUp(j,n));break;case 2:e.onTouchMove&&(H.transformInversePoint(a,n,j),e.onTouchMove(j,n))}const{children:r}=e;r&&r.forEach((e=>t(e,n,a,i)))}}(J||(J={}));const Q=H.empty(),tt=V.empty(),et=devicePixelRatio;var nt;!function(t){let e,n;t.render=function(t){!function(){const t=innerWidth*et|0,e=innerHeight*et|0;t!==n.width&&(n.width=t);e!==n.height&&(n.height=e);Q.a=Q.d=et}(),e.setTransform(),e.fillStyle="#bbbbbb",e.fillRect(0,0,n.width,n.height),J.render(t,Q,tt,e)},t.init=function(t){n=t,e=n.getContext("2d")}}(nt||(nt={}));var ot=function(t,e,n,o){return new(n||(n=Promise))((function(i,a){function r(t){try{c(o.next(t))}catch(t){a(t)}}function s(t){try{c(o.throw(t))}catch(t){a(t)}}function c(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(r,s)}c((o=o.apply(t,e||[])).next())}))};const it=document.getElementById("c");let at;nt.init(it);let rt=performance.now();function st(){requestAnimationFrame(st);const t=function(){const t=performance.now(),e=t-rt;return rt=t,e/1e3}();J.update(at,t),at.updateView(t),nt.render(at)}!function(){ot(this,void 0,void 0,(function*(){at=G({getWidth:()=>innerWidth,getHeight:()=>innerHeight}),rt=performance.now(),st(),document.addEventListener("keydown",(t=>{J.keyProcess(at,t,1),t.preventDefault()})),document.addEventListener("keyup",(t=>{J.keyProcess(at,t,0),t.preventDefault()})),it.addEventListener("mousedown",(t=>{const e={x:t.clientX*et,y:t.clientY*et};J.touchProcess(at,e,Q,1),t.preventDefault()})),it.addEventListener("mouseup",(t=>{const e={x:t.clientX*et,y:t.clientY*et};J.touchProcess(at,e,Q,0),t.preventDefault()})),it.addEventListener("mousemove",(t=>{const e={x:t.clientX*et,y:t.clientY*et};J.touchProcess(at,e,Q,2),t.preventDefault()}))}))}()}();
